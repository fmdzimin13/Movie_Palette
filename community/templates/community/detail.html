{% extends 'community_base.html' %}
{% comment %} 리뷰 삭제 / 댓글 삭제 / 리뷰 수정 버튼 구현{% endcomment %}
{% load humanize %}
{% load bootstrap5 %}

{% block content %}
  <div class="mt-5" style="border: 1px solid rgb(196, 196, 196); border-radius: 20px; width:70%;  margin: 0 auto;">
        <h2 class="py-1 m-3">"{{ review.title }}"</h2>
        <div class="d-flex pt-3 px-4" style="background-color: rgba(211, 211, 211, 0.63);">
          <h3>{{ review.movie.title }}</h3>
          <p class="mt-2 mx-3">{{ review.rank }}점 / 10점</p>
        </div>
        <div class="row p-2 m-3" >
          <div class="col-6 ">
            {{ review.content }}
          </div>
          <div class="col-6 px-4">
            <h5>COMMENT</h5>
            <p>{{ comments|length }}개의 댓글이 있습니다.</p><br>
            <form action="{% url 'community:create_comment' review.pk %}" method="POST" class="d-flex">
              {% csrf_token %}
              {{ comment_form.as_p }}
              <input class="mx-3 mb-3" type="submit" value="댓글 작성">
            </form>
            <hr>
            <ul class="list-group list-group-flush">
              {% for comment in comments %}
                <li class="list-group-item px-0">
                  <div class="d-flex justify-content-between">
                    <div>
                      <span style="font-size:18px;">{{ comment.user }} / </span>
                      <p>{{ comment.content }}</p>
                    </div>
                    <div>
                      <form class="mt-3" action="{% url 'community:delete_comment' review.pk comment.pk %}" method="POST">
                        {% csrf_token %}
                        {{ form.as_p }}
                        <input class="btn btn-outline-dark waves-effect" type="submit" value="delete">
                      </form>
                      <small class="mt-1">{{ comment.created_at|naturaltime }}</small>
                    </div>
                  </div>
                  <div class="d-flex">
                    
                  </div>
                </li>
              {% endfor %}
            </ul>
          </div>
        </div>
        <div class="mx-4 pt-3" style="border-top: 1px solid lightgrey;">
          <p class="d-flex justify-content-end mb-2 ">created by {{ review.user }} / {{ review.created_at|naturalday }}</p>
          <a style="font-size: 120%;" class="d-flex justify-content-end text-decoration-none text-dark" href="{% url 'accounts:profile' review.user.username %}"><b>{{ review.user }} <i class="fas fa-user-circle"></i></b></a>
        </div>
      </div>
    </div>
    <br>
    <div class="d-flex justify-content-between">
    
    <div class="btn-group">
      <div>
        <a href="{% url 'community:index' %}" class="btn btn-outline-secondary">BACK</a>
      </div>
    </div>
    <br>
    <br>
  </div>
{% endblock %}
